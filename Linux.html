<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Kirk Radio Linux OS with Mixxx</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/wavesurfer.js/6.4.0/wavesurfer.min.js"></script>
    <style>
        :root {
            --primary-bg: #1a1a2e;
            --secondary-bg: #16213e;
            --accent-color: #e94560;
            --text-color: #ffffff;
        }

        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            font-family: 'Ubuntu', sans-serif;
            background-color: var(--primary-bg);
            color: var(--text-color);
            overflow: hidden;
        }

        #linux-desktop {
            display: flex;
            height: 100vh;
        }

        #sidebar {
            width: 250px;
            background-color: var(--secondary-bg);
            padding: 20px;
            display: flex;
            flex-direction: column;
        }

        .app-section {
            margin-bottom: 20px;
        }

        .app-icon {
            display: flex;
            align-items: center;
            padding: 10px;
            margin-bottom: 10px;
            background-color: rgba(233, 69, 96, 0.1);
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .app-icon:hover {
            background-color: rgba(233, 69, 96, 0.2);
            transform: scale(1.05);
        }

        .app-icon img {
            width: 32px;
            height: 32px;
            margin-right: 10px;
        }

        #main-content {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }

        #terminal {
            flex-grow: 1;
            background-color: black;
            color: #0f0;
            padding: 15px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
        }

        #command-input {
            width: 100%;
            padding: 10px;
            background-color: #222;
            color: #0f0;
            border: none;
            font-family: 'Courier New', monospace;
        }

        #mixxx-app {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            background-color: #2a2a2a;
        }

        .mixxx-interface {
            display: flex;
            flex-grow: 1;
        }

        .deck {
            flex-grow: 1;
            background-color: #1a1a1a;
            margin: 10px;
            padding: 15px;
            display: flex;
            flex-direction: column;
        }

        .waveform {
            width: 100%;
            height: 200px;
            background-color: #3a3a3a;
            margin-bottom: 10px;
        }

        .mixxx-controls {
            display: flex;
            background-color: #3a3a3a;
            padding: 10px;
            justify-content: space-between;
        }

        .mixxx-controls button {
            background-color: var(--accent-color);
            color: white;
            border: none;
            padding: 10px;
            margin: 0 5px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div id="linux-desktop">
        <div id="sidebar">
            <div class="app-section">
                <h3>Applications</h3>
                <div class="app-icon" data-app="terminal">
                    <img src="https://cdn-icons-png.flaticon.com/512/2535/2535524.png" alt="Terminal">
                    Terminal
                </div>
                <div class="app-icon" data-app="mixxx">
                    <img src="https://mixxx.org/images/icon.png" alt="Mixxx">
                    Mixxx DJ
                </div>
                <div class="app-icon" data-app="file-manager">
                    <img src="https://cdn-icons-png.flaticon.com/512/2503/2503508.png" alt="File Manager">
                    File Manager
                </div>
            </div>
        </div>
        
        <div id="main-content">
            <div id="terminal">
                Welcome to Kirk Radio Linux OS
                Type 'help' for available commands
            </div>
            <input type="text" id="command-input" placeholder="Enter command...">
        </div>
    </div>

    <script>
        class KirkLinuxOS {
            constructor() {
                this.initializeSystem();
            }

            initializeSystem() {
                this.state = {
                    hostname: 'kirkradio-linux',
                    username: 'kirk',
                    osVersion: '2.0.0',
                    kernel: 'KirkLinux Kernel'
                };

                this.fileSystem = {
                    '/home/kirk': ['documents', 'music', 'downloads'],
                    '/home/kirk/music': ['sample1.mp3', 'sample2.mp3', 'kirkradio_mix.mp3']
                };
            }

            processCommand(command) {
                const [cmd, ...args] = command.split(' ');
                
                const commandHandlers = {
                    'help': () => this.showHelp(),
                    'ls': () => this.listDirectory(args[0] || '/home/kirk'),
                    'pwd': () => '/home/kirk',
                    'whoami': () => this.state.username,
                    'sysinfo': () => this.getSystemInfo()
                };

                return commandHandlers[cmd] 
                    ? commandHandlers[cmd]() 
                    : `Command not found: ${command}`;
            }

            showHelp() {
                return `
Kirk Radio Linux OS - Help

Basic Commands:
- help: Show this help menu
- ls: List directory contents
- pwd: Print working directory
- whoami: Show current user
- sysinfo: Display system information

Mixxx Commands:
- mixxx:load [deck] [track]: Load track to deck
- mixxx:play [deck]: Play track on deck
- mixxx:pause [deck]: Pause track on deck
                `;
            }

            listDirectory(path) {
                return this.fileSystem[path] 
                    ? this.fileSystem[path].join('\n')
                    : `Directory not found: ${path}`;
            }

            getSystemInfo() {
                return `
Kirk Radio Linux OS
- Hostname: ${this.state.hostname}
- Username: ${this.state.username}
- OS Version: ${this.state.osVersion}
- Kernel: ${this.state.kernel}
                `;
            }
        }

        class WebMixxxController {
            constructor() {
                this.decks = {
                    1: {
                        wavesurfer: null,
                        audioElement: null,
                        isPlaying: false,
                        currentTrack: null
                    },
                    2: {
                        wavesurfer: null,
                        audioElement: null,
                        isPlaying: false,
                        currentTrack: null
                    }
                };

                this.tracks = [
                    { 
                        name: 'sample1.mp3', 
                        path: '/home/kirk/music/sample1.mp3' 
                    },
                    { 
                        name: 'sample2.mp3', 
                        path: '/home/kirk/music/sample2.mp3' 
                    },
                    { 
                        name: 'kirkradio_mix.mp3', 
                        path: '/home/kirk/music/kirkradio_mix.mp3' 
                    }
                ];

                this.initializeDecks();
            }

            initializeDecks() {
                Object.keys(this.decks).forEach(deckNumber => {
                    const wavesurfer = WaveSurfer.create({
                        container: `#waveform${deckNumber}`,
                        waveColor: 'violet',
                        progressColor: 'purple',
                        responsive: true,
                        height: 200
                    });

                    this.decks[deckNumber].wavesurfer = wavesurfer;
                });
            }

            loadTrack(deckNumber, trackName) {
                const track = this.tracks.find(t => t.name === trackName);
                if (!track) {
                    return `Track not found: ${trackName}`;
                }

                // Simulate file loading (in real scenario, use actual file path)
                const mockFileURL = `https://kirkradio.net/music/${track.name}`;
                
                const deck = this.decks[deckNumber];
                deck.wavesurfer.load(mockFileURL);
                
                // Create audio element
                deck.audioElement = new Audio(mockFileURL);
                deck.currentTrack = track;

                return `Loaded ${track.name} on Deck ${deckNumber}`;
            }

            play(deckNumber) {
                const deck = this.decks[deckNumber];
                
                if (deck.audioElement) {
                    deck.audioElement.play();
                    deck.wavesurfer.play();
                    deck.isPlaying = true;
                    return `Playing ${deck.currentTrack.name} on Deck ${deckNumber}`;
                }

                return `No track loaded on Deck ${deckNumber}`;
            }

            pause(deckNumber) {
                const deck = this.decks[deckNumber];
                
                if (deck.audioElement) {
                    deck.audioElement.pause();
                    deck.wavesurfer.pause();
                    deck.isPlaying = false;
                    return `Paused ${deck.currentTrack.name} on Deck ${deckNumber}`;
                }

                return `No track loaded on Deck ${deckNumber}`;
            }

            listTracks() {
                return this.tracks.map((track, index) => 
                    `${index + 1}. ${track.name}`
                ).join('\n');
            }
        }

        // Global instances
        const linuxOS = new KirkLinuxOS();
        const mixxxController = new WebMixxxController();

        // DOM Elements
        const terminal = document.getElementById('terminal');
        const commandInput = document.getElementById('command-input');
        const sidebar = document.getElementById('sidebar');
        const mainContent = document.getElementById('main-content');

        // Command input handler
        commandInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                const command = commandInput.value.trim();
                
                // Display command
                terminal.innerHTML += `\n<span style="color: yellow;">$ </span>${command}\n`;
                
                // Process command
                let result = '';
                if (command.startsWith('mixxx:')) {
                    // Mixxx-specific commands
                    const [, mixxxCmd, ...args] = command.split(':')[1].split(' ');
                    switch(mixxxCmd) {
                        case 'tracks':
                            result = mixxxController.listTracks();
                            break;
                        case 'load':
                            result = mixxxController.loadTrack(args[0], args[1]);
                            break;
                        case 'play':
                            result = mixxxController.play(args[0]);
                            break;
                        case 'pause':
                            result = mixxxController.pause(args[0]);
                            break;
                        default:
                            result = 'Unknown Mixxx command';
                    }
                } else {
                    // Linux OS commands
                    result = linuxOS.processCommand(command);
                }
                
                // Display result
                terminal.innerHTML += `<pre>${result}</pre>`;
                
                // Scroll to bottom
                terminal.scrollTop = terminal.scrollHeight;
                
                // Clear input
                commandInput.value = '';
            }
        });

        // Sidebar application launcher
        sidebar.addEventListener('click', (e) => {
            const appIcon = e.target.closest('.app-icon');
            if (appIcon) {
                const app = appIcon.dataset.app;
                
                switch(app) {
                    case 'terminal':
                        renderTerminal();
                        break;
                    case 'mixxx':
                        renderMixxxApp();
                        break;
                    case 'file-manager':
                        renderFileManager();
                        break;
                }
            }
        });

        // Render Mixxx Application
        function renderMixxxApp() {
            mainContent.innerHTML = `
                <div id="mixxx-app">
                    <div class="mixxx-interface">
                        <div class="deck" id="deck1">
                            <h3>Deck 1</h3>
                            <div id="waveform1" class="waveform"></div>
                        </div>
                        <div class="deck" id="deck2">
                            <h3>Deck 2</h3>
                            <div id="waveform2" class="waveform"></div>
                        </div>
                    </div>
                    
                    <div class="mixxx-controls">
                        <button onclick="mixxxCommand('load 1 sample1.mp3')">Load Sample 1</button>
                        <button onclick="mixxxCommand('play 1')">Play Deck 1</button>
                        <button onclick="mixxxCommand('pause 1')">Pause Deck 1</button>
                        <button onclick="mixxxCommand('load 2 sample2.mp3')">Load Sample 2</button>
                        <button onclick="mixxxCommand('play 2')">Play Deck 2</button>
                        <button onclick="mixxxCommand('pause 2')">Pause Deck 2</button>
                    </div>
                </div>
            `;

            // Reinitialize wavesurfer after rendering
            mixxxController.initializeDecks();
        }

        // Mixxx command handler for UI
        function mixxxCommand(cmd) {
            const [command, ...args] = cmd.split(' ');
            let result = '';

            switch(command) {
                case 'load':
                    result = mixxxController.loadTrack(args[0], args[1]);
                    break;
                case 'play':
                    result = mixxxController.play(args[0]);
                    break;
                case 'pause':
                    result = mixxxController.pause(args[0]);
                    break;
            }
            
            // Update terminal
            terminal.innerHTML += `\n<pre>${result}</pre>`;
            terminal.scrollTop = terminal.scrollHeight;
        }

        // Render File Manager
        function renderFileManager() {
            mainContent.innerHTML = `
                <div id="file-manager">
                    <h2>File Manager</h2>
                    <pre>${linuxOS.listDirectory('/home/kirk')}</pre>
                </div>
            `;
        }

        // Render Terminal
        function renderTerminal() {
            mainContent.innerHTML = `
                <div id="terminal">
                    Welcome to Kirk Radio Linux OS
                    Type 'help' for available commands
                </div>
                <input type="text" id="command-input" placeholder="Enter command...">
            `;
        }
    </script>
</body>
</html>

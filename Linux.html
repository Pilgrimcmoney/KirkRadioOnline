<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Kirk Radio Linux OS</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/wavesurfer.js/6.4.0/wavesurfer.min.js"></script>
    <style>
        :root {
            --primary-bg: #1a1a2e;
            --secondary-bg: #16213e;
            --accent-color: #e94560;
            --text-color: #ffffff;
        }

        body, html {
            height: 100%;
            margin: 0;
            font-family: 'Ubuntu', sans-serif;
            background-color: var(--primary-bg);
            color: var(--text-color);
            overflow: hidden;
        }

        #desktop {
            display: flex;
            height: 100vh;
        }

        #sidebar {
            width: 250px;
            background-color: var(--secondary-bg);
            padding: 20px;
        }

        .app-icon {
            display: flex;
            align-items: center;
            padding: 10px;
            margin-bottom: 10px;
            background-color: rgba(233, 69, 96, 0.1);
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .app-icon:hover {
            background-color: rgba(233, 69, 96, 0.2);
            transform: scale(1.05);
        }

        .app-icon img {
            width: 32px;
            height: 32px;
            margin-right: 10px;
        }

        #content-area {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }

        #terminal {
            flex-grow: 1;
            background-color: black;
            color: #0f0;
            padding: 15px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
        }

        #command-input {
            width: 100%;
            padding: 10px;
            background-color: #222;
            color: #0f0;
            border: none;
            font-family: 'Courier New', monospace;
        }

        .modal {
            background-color: rgba(0,0,0,0.7);
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal-content {
            background-color: var(--secondary-bg);
            padding: 20px;
            border-radius: 10px;
            width: 80%;
            max-width: 600px;
        }
    </style>
</head>
<body>
    <div id="desktop">
        <div id="sidebar">
            <h3 class="text-center mb-4">Kirk Radio OS</h3>
            
            <div class="app-section">
                <h5>System Tools</h5>
                <div class="app-icon" data-app="terminal">
                    <img src="https://cdn-icons-png.flaticon.com/512/2535/2535524.png" alt="Terminal">
                    Terminal
                </div>
                <div class="app-icon" data-app="mixxx">
                    <img src="https://mixxx.org/images/icon.png" alt="Mixxx">
                    Mixxx DJ
                </div>
                <div class="app-icon" data-app="file-manager">
                    <img src="https://cdn-icons-png.flaticon.com/512/2503/2503508.png" alt="File Manager">
                    File Manager
                </div>
            </div>
        </div>
        
        <div id="content-area">
            <div id="terminal">
                Welcome to Kirk Radio Linux OS
                Click an application to begin
            </div>
            <input type="text" id="command-input" placeholder="Enter command...">
        </div>
    </div>

    <!-- Modals -->
    <div id="mixxx-modal" class="modal">
        <div class="modal-content">
            <h2>Mixxx DJ Controller</h2>
            <div id="mixxx-interface">
                <div class="row">
                    <div class="col-6">
                        <h3>Deck 1</h3>
                        <div id="waveform1" style="height: 100px; background-color: #333;"></div>
                        <input type="file" id="file-input1" accept="audio/*">
                        <div class="mt-2">
                            <button onclick="mixxxController.loadTrack(1)" class="btn btn-primary">Load</button>
                            <button onclick="mixxxController.play(1)" class="btn btn-success">Play</button>
                            <button onclick="mixxxController.pause(1)" class="btn btn-warning">Pause</button>
                        </div>
                    </div>
                    <div class="col-6">
                        <h3>Deck 2</h3>
                        <div id="waveform2" style="height: 100px; background-color: #333;"></div>
                        <input type="file" id="file-input2" accept="audio/*">
                        <div class="mt-2">
                            <button onclick="mixxxController.loadTrack(2)" class="btn btn-primary">Load</button>
                            <button onclick="mixxxController.play(2)" class="btn btn-success">Play</button>
                            <button onclick="mixxxController.pause(2)" class="btn btn-warning">Pause</button>
                        </div>
                    </div>
                </div>
            </div>
            <button onclick="closeModal('mixxx-modal')" class="btn btn-danger mt-3">Close</button>
        </div>
    </div>

    <script>
        class MixxxController {
            constructor() {
                this.decks = {
                    1: { 
                        wavesurfer: null, 
                        audioElement: null, 
                        isPlaying: false 
                    },
                    2: { 
                        wavesurfer: null, 
                        audioElement: null, 
                        isPlaying: false 
                    }
                };
                this.initializeWavesurfer();
            }

            initializeWavesurfer() {
                // Initialize Wavesurfer for each deck
                this.decks[1].wavesurfer = WaveSurfer.create({
                    container: '#waveform1',
                    waveColor: 'violet',
                    progressColor: 'purple',
                    responsive: true,
                    height: 100
                });

                this.decks[2].wavesurfer = WaveSurfer.create({
                    container: '#waveform2',
                    waveColor: 'green',
                    progressColor: 'blue',
                    responsive: true,
                    height: 100
                });
            }

            loadTrack(deckNumber) {
                const fileInput = document.getElementById(`file-input${deckNumber}`);
                fileInput.onchange = (event) => {
                    const file = event.target.files[0];
                    const fileURL = URL.createObjectURL(file);
                    
                    const deck = this.decks[deckNumber];
                    
                    // Load audio into wavesurfer
                    deck.wavesurfer.load(fileURL);
                    
                    // Create audio element
                    deck.audioElement = new Audio(fileURL);
                    
                    // Log to terminal
                    updateTerminal(`Loaded track on Deck ${deckNumber}: ${file.name}`);
                };

                fileInput.click();
            }

            play(deckNumber) {
                const deck = this.decks[deckNumber];
                
                if (deck.audioElement) {
                    deck.audioElement.play();
                    deck.wavesurfer.play();
                    deck.isPlaying = true;
                    updateTerminal(`Playing track on Deck ${deckNumber}`);
                } else {
                    updateTerminal(`No track loaded on Deck ${deckNumber}`);
                }
            }

            pause(deckNumber) {
                const deck = this.decks[deckNumber];
                
                if (deck.audioElement) {
                    deck.audioElement.pause();
                    deck.wavesurfer.pause();
                    deck.isPlaying = false;
                    updateTerminal(`Paused track on Deck ${deckNumber}`);
                } else {
                    updateTerminal(`No track loaded on Deck ${deckNumber}`);
                }
            }
        }

        // Global instances
        const mixxxController = new MixxxController();

        // Utility Functions
        function updateTerminal(message) {
            const terminal = document.getElementById('terminal');
            terminal.innerHTML += `\n> ${message}`;
            terminal.scrollTop = terminal.scrollHeight;
        }

        function openModal(modalId) {
            document.getElementById(modalId).style.display = 'flex';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // Event Listeners
        document.getElementById('sidebar').addEventListener('click', (e) => {
            const appIcon = e.target.closest('.app-icon');
            if (appIcon) {
                const app = appIcon.dataset.app;
                
                switch(app) {
                    case 'terminal':
                        // Already in terminal view
                        break;
                    case 'mixxx':
                        openModal('mixxx-modal');
                        break;
                    case 'file-manager':
                        updateTerminal('File Manager: Not implemented');
                        break;
                }
            }
        });

        // Command Input
        document.getElementById('command-input').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                const command = e.target.value.trim().toLowerCase();
                updateTerminal(`Command: ${command}`);
                
                // Basic command handling
                switch(command) {
                    case 'help':
                        updateTerminal(`
Available Commands:
- help: Show this help menu
- about: Show system information
- clear: Clear terminal
                        `);
                        break;
                    case 'about':
                        updateTerminal(`
Kirk Radio Linux OS
Version: 1.0.0
Developed by Kirk Radio Team
                        `);
                        break;
                    case 'clear':
                        document.getElementById('terminal').innerHTML = '';
                        break;
                    default:
                        updateTerminal(`Unknown command: ${command}`);
                }
                
                e.target.value = '';
            }
        });
    </script>
</body>
</html>
